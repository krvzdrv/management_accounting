# Исправление ошибки Malformed auth code

## Проблема

Ошибка `Malformed auth code` означает что:
- Код скопирован не полностью
- В коде есть лишние символы или пробелы
- Код обрезан при копировании

## Решение: Правильно скопировать код

### Важно: Код должен быть полным

Код авторизации должен выглядеть примерно так:
```
4/0ATX87IPQgby30M9WbfNgoKLTVn_ZmRNSB787kfl31wywToN_Dq3IdBRZ4wlK1rIFQtfPNg
```

**Проверьте:**
- ✅ Код начинается с `4/0A...`
- ✅ Код длинный (50+ символов)
- ✅ Нет пробелов в начале или конце
- ✅ Нет символов `&` или других лишних символов

### Как правильно скопировать

**Способ 1: Из адресной строки браузера**

1. В адресной строке браузера найдите URL:
   ```
   localhost:3000/oauth2callback?code=4/0ATX87...длинная_строка...&scope=...
   ```

2. **Выделите только код:**
   - Начните выделение сразу после `code=`
   - Закончите выделение перед `&` (или перед `&scope=`)
   - Скопируйте (Cmd+C)

3. **Проверьте что скопировали:**
   - Код должен начинаться с `4/0A`
   - Код должен быть длинным
   - Не должно быть `code=` в начале
   - Не должно быть `&scope=` в конце

**Способ 2: Через Инструменты разработчика**

1. Откройте Инструменты разработчика (F12 или Cmd+Option+I)
2. Перейдите на вкладку **Network** (Сеть)
3. Найдите запрос к `localhost:3000/oauth2callback`
4. Посмотрите URL запроса - там будет параметр `code=...`
5. Скопируйте код оттуда

### Проверка перед вводом

Перед вводом кода в терминал проверьте:

1. **Код начинается правильно:**
   - Должно быть: `4/0A...`
   - Не должно быть: `code=4/0A...` (уберите `code=`)

2. **Код заканчивается правильно:**
   - Не должно быть: `...&scope=...` (уберите все после кода)

3. **Нет пробелов:**
   - Проверьте что нет пробелов в начале или конце
   - Проверьте что код на одной строке

---

## Альтернатива: Использовать полный URL

Если код все равно не работает, можно попробовать использовать полный URL с кодом (но это обычно не работает).

---

## Попробуйте еще раз

1. **Запустите скрипт снова:**
   ```bash
   rm -f token.json
   node update-scripts.js
   ```

2. **Получите новый код** (коды одноразовые)

3. **Скопируйте код правильно:**
   - Только код, без `code=` и без `&scope=`
   - Полностью, без обрезки

4. **Вставьте в терминал сразу** (коды истекают быстро)

---

## Если все еще не работает

Попробуйте:
1. Использовать другой браузер
2. Скопировать код через Инструменты разработчика
3. Проверить что redirect_uri правильный в credentials.json

---

## Напишите мне

После правильного копирования кода напишите:
- **"Готово, код введен правильно"** - если все работает
- **"Все еще ошибка Malformed auth code"** - если проблема повторяется

Или опишите как вы копируете код - я помогу найти проблему!

