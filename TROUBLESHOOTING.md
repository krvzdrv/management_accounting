# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

## –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç

### –û—à–∏–±–∫–∞: "API returned unsuccessful response"

**–ü—Ä–∏—á–∏–Ω–∞:** API –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –∏–∑–º–µ–Ω–∏–ª —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ:**

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å—ã –≤—Ä—É—á–Ω—É—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –í Google –¢–∞–±–ª–∏—Ü–∞—Ö –æ—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é **üíº –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á–µ—Ç**
2. –í—ã–±–µ—Ä–∏—Ç–µ **üí± –í–∞–ª—é—Ç—ã** ‚Üí **–î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å –≤—Ä—É—á–Ω—É—é**
3. –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   - –í–∞–ª—é—Ç–∞ –û–¢ (–Ω–∞–ø—Ä–∏–º–µ—Ä: EUR)
   - –í–∞–ª—é—Ç–∞ –ö (–Ω–∞–ø—Ä–∏–º–µ—Ä: PLN)
   - –ö—É—Ä—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 4.35)
4. –ù–∞–∂–º–∏—Ç–µ OK

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ —Ç–∞–±–ª–∏—Ü—É

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–∏—Å—Ç **Exchange_Rates**
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É:
   - `rate_id` - —Å–ª–µ–¥—É—é—â–∏–π –Ω–æ–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3)
   - `currency_from` - EUR
   - `currency_to` - PLN
   - `rate` - –∫—É—Ä—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, 4.35)
   - `rate_date` - —Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞
   - `source` - manual
   - `created_at` - —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–ø—Ä—è–º—É—é

–í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```javascript
addExchangeRate('EUR', 'PLN', 4.35, new Date());
```

### –î—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å API

**–ü—Ä–æ–±–ª–µ–º–∞:** API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ (API –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤

## –û–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞: "Sheet not found"

**–ü—Ä–∏—á–∏–Ω–∞:** –õ–∏—Å—Ç —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤ –≤ Google –¢–∞–±–ª–∏—Ü–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–∏ —Ç–æ—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –Ω–∞–∑–≤–∞–Ω–∏—è–º –≤ `Config.gs`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `initializeSystem()` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤

### –û—à–∏–±–∫–∞: "Function not found"

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –º–æ–¥—É–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (Ctrl+S)
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤

### –ú–µ–Ω—é –Ω–µ –ø–æ—è–≤–∏–ª–æ—Å—å

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∞–π–ª `Main.gs` –Ω–µ —Å–æ–∑–¥–∞–Ω –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è `onOpen()` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `Main` —Å–æ–∑–¥–∞–Ω –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Å–∫—Ä–∏–ø—Ç–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ –∏–∑ `Main.gs` —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É Google –¢–∞–±–ª–∏—Ü—ã (F5)
4. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∑–∞–Ω–æ–≤–æ

### –û—à–∏–±–∫–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (–í–∏–¥ ‚Üí –õ–æ–≥–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Å–∫—Ä–∏–ø—Ç–æ–≤)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü

```javascript
function checkSheets() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheets = ss.getSheets();
  sheets.forEach(sheet => {
    Logger.log(sheet.getName() + ': ' + sheet.getLastRow() + ' —Å—Ç—Ä–æ–∫');
  });
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç

```javascript
function checkRates() {
  const sheet = getSheet(CONFIG.SHEET_NAMES.EXCHANGE_RATES);
  const data = sheet.getDataRange().getValues();
  Logger.log('–í—Å–µ–≥–æ –∫—É—Ä—Å–æ–≤: ' + (data.length - 1));
  for (let i = 1; i < data.length; i++) {
    Logger.log(data[i][1] + '/' + data[i][2] + ' = ' + data[i][3]);
  }
}
```

### –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞

```javascript
function testGetRate() {
  try {
    const rate = getExchangeRate('EUR', 'PLN', new Date());
    Logger.log('–ö—É—Ä—Å EUR/PLN: ' + rate);
  } catch (error) {
    Logger.log('–û—à–∏–±–∫–∞: ' + error.message);
  }
}
```

## –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ (–í–∏–¥ ‚Üí –õ–æ–≥–∏)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –º–æ–¥—É–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ `initializeSystem()`

---

**–í–∞–∂–Ω–æ:** –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ —Å–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º.

