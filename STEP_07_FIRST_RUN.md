# –®–ê–ì 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ credentials.json –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è Git

```bash
git status
```

–§–∞–π–ª `credentials.json` **–ù–ï –¥–æ–ª–∂–µ–Ω** –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π. –ï—Å–ª–∏ –ø–æ—è–≤–∏–ª—Å—è - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `.gitignore`.

### 2. –ü–æ–ª—É—á–∏—Ç–µ Script ID –∏–∑ Google Apps Script

**–í–∞–∂–Ω–æ:** –ù—É–∂–µ–Ω ID –≤–∞—à–µ–≥–æ Apps Script –ø—Ä–æ–µ–∫—Ç–∞.

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Script ID:**

**–í–∞—Ä–∏–∞–Ω—Ç A: –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å Apps Script –ø—Ä–æ–µ–∫—Ç:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ [script.google.com](https://script.google.com)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π)
3. –í –º–µ–Ω—é: **Project Settings** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞)
4. –ù–∞–π–¥–∏—Ç–µ **Script ID** - —ç—Ç–æ –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞: `1AbCdEfGhIjKlMnOpQrStUvWxYz1234567890`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç ID

**–í–∞—Ä–∏–∞–Ω—Ç B: –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞ –µ—â–µ –Ω–µ—Ç:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É Google Sheets —Ç–∞–±–ª–∏—Ü—É
2. –í –º–µ–Ω—é: **Extensions** ‚Üí **Apps Script**
3. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä Apps Script
4. –í –º–µ–Ω—é: **Project Settings** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞)
5. –ù–∞–π–¥–∏—Ç–µ **Script ID** –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ

### 3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env

**–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ:**
```bash
cd "/Volumes/02 Data/work/Alumineu/GitHub/management_accounting"
```

**–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env:**

```bash
nano .env
```

**–í—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ** (–∑–∞–º–µ–Ω–∏—Ç–µ `YOUR_SCRIPT_ID` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π Script ID):

```env
# Google OAuth Credentials (–∏–∑ credentials.json)
GOOGLE_CLIENT_ID=YOUR_CLIENT_ID
GOOGLE_CLIENT_SECRET=YOUR_CLIENT_SECRET

# Google Apps Script Project ID
GOOGLE_SCRIPT_ID=YOUR_SCRIPT_ID

# GitHub Repository (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ GitHub)
GITHUB_REPO_URL=https://github.com/your-username/management_accounting
GITHUB_BRANCH=main
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ:**
- `Ctrl+O` ‚Üí `Enter` ‚Üí `Ctrl+X`

**–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
```bash
chmod 600 .env
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ .env –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è Git

```bash
git status
```

–§–∞–π–ª `.env` **–ù–ï –¥–æ–ª–∂–µ–Ω** –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

### 5. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—Ç–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

```bash
node update-scripts.js
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**

1. –°–∫—Ä–∏–ø—Ç –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ OAuth
2. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä —Å –∑–∞–ø—Ä–æ—Å–æ–º –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à Google –∞–∫–∫–∞—É–Ω—Ç
4. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø (–Ω–∞–∂–º–∏—Ç–µ "Allow")
5. –°–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Ç–æ–∫–µ–Ω –≤ `token.json`
6. –î–∞–ª—å—à–µ —Å–∫—Ä–∏–ø—Ç –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã –≤ Apps Script

**–ï—Å–ª–∏ –≤—Å–µ —Ö–æ—Ä–æ—à–æ:**
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç—Å—è —Ñ–∞–π–ª `token.json`
- ‚úÖ –°–∫—Ä–∏–ø—Ç –Ω–∞—á–Ω–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Ñ–∞–π–ª—ã –≤ Apps Script
- ‚úÖ –í—ã —É–≤–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ

**–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Script ID –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Apps Script API –≤–∫–ª—é—á–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ OAuth –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ token.json —Å–æ–∑–¥–∞–Ω

```bash
ls -la token.json
```

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞.

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ token.json –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è Git

```bash
git status
```

–§–∞–π–ª `token.json` **–ù–ï –¥–æ–ª–∂–µ–Ω** –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ.

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Apps Script –ø—Ä–æ–µ–∫—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ [script.google.com](https://script.google.com)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–∏–ª–∏—Å—å (–µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è)

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞: "Script ID not found"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Script ID –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ `.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Apps Script

### –û—à–∏–±–∫–∞: "OAuth authorization failed"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `credentials.json` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ OAuth Consent Screen –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–¥–∞–ª–∏—Ç—å `token.json` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞

### –û—à–∏–±–∫–∞: "API not enabled"

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Apps Script API –≤–∫–ª—é—á–µ–Ω –≤ Google Cloud Console

---

## –ù–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–∞–ø–∏—à–∏—Ç–µ:

- **"–ì–æ—Ç–æ–≤–æ, –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ —É—Å–ø–µ—à–µ–Ω"** - –µ—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **"–ü—Ä–æ–±–ª–µ–º–∞: [–æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏]"** - –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

